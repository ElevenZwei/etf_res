# 20250923 亏损调查  

这一天里面的 1810 实盘账号出现了远远大于预期的亏损。  
问题可能出在时间延迟，或者下单延迟，或者大额滑点上。  
我们需要把回测和实盘的所有价格进行比较之后做出检查。  

NOTE: 有一些插件显示兼容性的问题需要处理，mkdx 在生成格式化表格的时候会使用 tab 键而不是 space 来控制大缩进，这个在 preview 渲染的时候会导致对齐问题。  
mkdx 需要一些额外的设置解决这个问题。  
然后是我自己的 markdown 回车加上空格的代码，如果这一行的最后一个字符是 | 的话，那么不应该添加空格。

## 回测情况  
根据 cpr.roll_merged 表格给出的反馈，这一点的 spot 收益是 -1.48% .  

|    date    |         daily         |     accumulated     |
|------------|-----------------------|---------------------|
| 2025-09-22 | 0.0020711411948455966 | 0.3215786590877722  |
| 2025-09-23 | -0.01485587830476517  | 0.3067227807830071  |
| 2025-09-24 | 0.018997777183883312  | 0.32572055796689037 |
| 2025-09-25 | 0.014695050509309924  | 0.3404156084762003  |
| 2025-09-26 | 0.011613209645223443  | 0.3520288181214237  |




## 实盘情况  
实盘情况分成很多层面。  

### cpr 信号生成的时间  
cpr python 脚本后来运行的信号生成理想时间是这样。  
但是生成这些信号的时间应该晚了 30 秒。  

| roll_args_id | top |            dt             |          dt_raw           | open_count | position |
|--------------|-----|---------------------------|---------------------------|------------|----------|
|      1       | 10  | 2025-09-23 09:35:00+08:00 | 2025-09-23 09:35:01+08:00 |    10.0    |   1.0    |
|      1       | 10  | 2025-09-23 10:06:00+08:00 | 2025-09-23 10:06:00+08:00 |    9.0     |   0.9    |
|      1       | 10  | 2025-09-23 10:24:00+08:00 | 2025-09-23 10:24:01+08:00 |    6.0     |   0.6    |
|      1       | 10  | 2025-09-23 11:24:00+08:00 | 2025-09-23 11:24:01+08:00 |    0.0     |   0.0    |
|      1       | 10  | 2025-09-23 13:00:00+08:00 | 2025-09-23 13:00:01+08:00 |    1.0     |   -0.1   |
|      1       | 10  | 2025-09-23 14:51:00+08:00 | 2025-09-23 14:51:01+08:00 |    0.0     |   0.0    |



### spirit 信号生成的时间  
我们看到这里都是在 30 秒靠后的时候生成信号，说明 cpr python 脚本写入信号的时间应该是 30 秒。  


|   code   | position    | updated_at |
|----------|---------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------|
| 90005453 | {"code": "90006226", "amount": -14, "contract": "159915P2509M003100"}, {"code": "90006225", "amount": 14, "contract": "159915C2509M003100"} | 2025-09-23 09:36:32.081739+08 |
| 90005453 | {"code": "90006226", "amount": -12, "contract": "159915P2509M003100"}, {"code": "90006225", "amount": 12, "contract": "159915C2509M003100"} | 2025-09-23 10:06:34.957029+08 |
| 90005453 |  {"code": "90006226", "amount": -8, "contract": "159915P2509M003100"}, {"code": "90006225", "amount": 8, "contract": "159915C2509M003100"}  | 2025-09-23 10:24:34.488542+08 |
| 90005453 | | 2025-09-23 11:24:34.276317+08 |
| 90005453 |  {"code": "90006198", "amount": 1, "contract": "159915P2509M003000"}, {"code": "90006197", "amount": -1, "contract": "159915C2509M003000"}  | 2025-09-23 13:00:34.144114+08 |
| 90005453 | | 2025-09-23 14:46:07.338407+08 |


